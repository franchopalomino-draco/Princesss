<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>ğŸ“Š Escala de Clima Laboral CL-SPC</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['"Montserrat"', 'sans-serif']
          }
        }
      }
    }
  </script>
  <style>
    body {
      background: linear-gradient(135deg, #f0f9ff 0%, #f8f4ff 100%);
      font-family: 'Montserrat', sans-serif;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }
    .sparkle {
      position: absolute;
      pointer-events: none;
      opacity: 0.6;
      z-index: 0;
      font-size: 1rem;
    }
  </style>
</head>
<body class="min-h-screen py-4 px-2 relative overflow-hidden">
  <!-- Sparkles decorativos -->
  <div class="sparkle" style="top:10%; left:5%;">ğŸ“Š</div>
  <div class="sparkle" style="top:25%; right:8%;">ğŸ“ˆ</div>
  <div class="sparkle" style="bottom:20%; left:10%;">ğŸ’¼</div>
  <div class="sparkle" style="bottom:30%; right:12%;">ğŸ”</div>

  <!-- Contenedor principal -->
  <div id="app" class="max-w-xl mx-auto bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl p-5 border border-blue-100 relative z-10">
    <!-- Pantalla de bienvenida -->
    <div id="welcomeScreen" class="text-center">
      <h1 class="text-3xl font-bold text-blue-700 mb-3">Escala de Clima Laboral CL-SPC</h1>
      <p class="text-gray-700 text-sm mb-6">Responde 50 preguntas y obtÃ©n un diagnÃ³stico profesional de tu clima laboral.</p>
      <button id="startBtn" class="bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-bold py-3 px-8 rounded-full text-lg transition shadow-lg">
        Â¡Comenzar EvaluaciÃ³n!
      </button>
      <div class="mt-6 text-xl">ğŸ”ğŸ“ŠğŸ’¼</div>
    </div>

    <!-- Pantalla de preguntas -->
    <div id="questionScreen" class="hidden">
      <div class="text-center mb-4">
        <div class="text-sm text-gray-500" id="progressText">Pregunta 1 de 50</div>
        <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
          <div id="progressBar" class="bg-blue-500 h-2 rounded-full" style="width: 2%"></div>
        </div>
      </div>
      <div id="questionText" class="text-lg font-medium mb-6 text-center"></div>
      <div id="optionsContainer" class="space-y-3"></div>
      <div class="flex justify-between mt-6">
        <button id="prevBtn" class="px-4 py-2 text-gray-600 font-medium rounded-lg hover:bg-gray-100 hidden">â† Anterior</button>
        <button id="nextBtn" class="px-6 py-2 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700">Siguiente â†’</button>
      </div>
    </div>

    <!-- Pantalla de resultado -->
    <div id="resultScreen" class="hidden text-center">
      <h2 class="text-2xl font-bold text-indigo-600 mb-4">Resultado del DiagnÃ³stico</h2>
      <div id="princessResult"></div>
      <div id="whatsappBtnContainer" class="mt-6"></div>
      <p class="mt-4 text-xs text-gray-500">Los resultados se enviarÃ¡n automÃ¡ticamente por WhatsApp.</p>
    </div>
  </div>

  <script>
    // Preguntas del CL-SPC (50 Ã­tems)
    const questions = [
      "Existen oportunidades de progresar en tu entorno.",
      "Te sientes comprometido con el Ã©xito de tu equipo.",
      "Tus lÃ­deres te brindan apoyo cuando enfrentas desafÃ­os.",
      "Tienes acceso a la informaciÃ³n que necesitas para hacer bien tu trabajo.",
      "Tus compaÃ±eros cooperan contigo de forma armoniosa.",
      "Tus superiores se interesan por tu crecimiento personal.",
      "Siempre das lo mejor de ti en cada tarea.",
      "Buscas mejorar continuamente en lo que haces.",
      "La informaciÃ³n fluye con claridad a tu alrededor.",
      "Tus metas son inspiradoras y desafiantes.",
      "Participas en definir tus objetivos.",
      "Sientes que eres clave para el Ã©xito colectivo.",
      "La retroalimentaciÃ³n que recibes te ayuda a crecer.",
      "Tu equipo tiene una relaciÃ³n armoniosa.",
      "Tienes libertad para tomar decisiones en tu rol.",
      "Se valora cuando das tu mÃ¡ximo esfuerzo.",
      "EstÃ¡s profundamente comprometido con tu misiÃ³n.",
      "Recibes la preparaciÃ³n necesaria para brillar.",
      "Hay canales claros para comunicarte.",
      "Tu equipo funciona como una verdadera familia.",
      "Reconocen tus logros con sinceridad.",
      "Cada dÃ­a buscas hacer las cosas mejor.",
      "Tus responsabilidades estÃ¡n bien definidas.",
      "Puedes interactuar fÃ¡cilmente con personas influyentes.",
      "Siempre buscas hacer tu mejor trabajo.",
      "Lo que haces te permite aprender y crecer.",
      "Tu trabajo diario contribuye a tu desarrollo personal.",
      "Tienes sistemas que te ayudan a organizarte.",
      "Juntos superan cualquier obstÃ¡culo.",
      "Los recursos se usan con sabidurÃ­a.",
      "Te ofrecen oportunidades para capacitarte.",
      "Tu labor diaria es estimulante y significativa.",
      "Tienes guÃ­as claras para cumplir tus tareas.",
      "La comunicaciÃ³n interna es abierta y fluida.",
      "Tu recompensa es justa comparada con otros.",
      "Tu entorno promueve tu crecimiento profesional.",
      "EstÃ¡s orgulloso de lo que haces cada dÃ­a.",
      "Tus objetivos estÃ¡n claramente definidos.",
      "Tus lÃ­deres escuchan tus ideas con atenciÃ³n.",
      "Tus metas estÃ¡n alineadas con un propÃ³sito mayor.",
      "Se fomenta la creatividad e innovaciÃ³n.",
      "Conoces la visiÃ³n, misiÃ³n y valores de tu entorno.",
      "Sigues planes y mÃ©todos bien establecidos.",
      "Existe colaboraciÃ³n entre todos los equipos.",
      "Cuentas con herramientas que facilitan tu trabajo.",
      "Reconocen tus logros con alegrÃ­a.",
      "Tu entorno es ideal para tu bienestar.",
      "Siempre se actÃºa con justicia y equidad.",
      "EstÃ¡s al tanto de lo que sucede en otros equipos.",
      "Tu recompensa refleja tu esfuerzo y resultados."
    ];

    const likertOptions = [
      { value: 1, label: "Nunca" },
      { value: 2, label: "Rara vez" },
      { value: 3, label: "A veces" },
      { value: 4, label: "Casi siempre" },
      { value: 5, label: "Siempre" }
    ];

    // Estado
    let currentQuestion = 0;
    const answers = new Array(50).fill(null);

    // Elementos del DOM
    const welcomeScreen = document.getElementById('welcomeScreen');
    const questionScreen = document.getElementById('questionScreen');
    const resultScreen = document.getElementById('resultScreen');
    const questionText = document.getElementById('questionText');
    const optionsContainer = document.getElementById('optionsContainer');
    const progressText = document.getElementById('progressText');
    const progressBar = document.getElementById('progressBar');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const startBtn = document.getElementById('startBtn');

    // Iniciar
    startBtn.addEventListener('click', () => {
      welcomeScreen.classList.add('hidden');
      questionScreen.classList.remove('hidden');
      loadQuestion(currentQuestion);
    });

    function loadQuestion(index) {
      questionText.textContent = `${index + 1}. ${questions[index]}`;
      progressText.textContent = `Pregunta ${index + 1} de 50`;
      progressBar.style.width = `${((index + 1) / 50) * 100}%`;

      optionsContainer.innerHTML = '';
      likertOptions.forEach(opt => {
        const id = `opt${opt.value}`;
        const checked = answers[index] === opt.value ? 'checked' : '';
        optionsContainer.innerHTML += `
          <div class="flex items-center justify-center">
            <input type="radio" name="currentAnswer" id="${id}" value="${opt.value}" class="radio-custom hidden" ${checked}>
            <label for="${id}" class="cursor-pointer w-full max-w-xs px-4 py-3 rounded-xl border border-gray-300 hover:bg-blue-50 transition text-center font-medium">${opt.label}</label>
          </div>
        `;
      });

      prevBtn.classList.toggle('hidden', index === 0);
      nextBtn.textContent = index === 49 ? 'Ver Resultado ğŸ“Š' : 'Siguiente â†’';
    }

    function saveAnswer() {
      const selected = document.querySelector('input[name="currentAnswer"]:checked');
      if (!selected) {
        alert("Por favor selecciona una opciÃ³n.");
        return false;
      }
      answers[currentQuestion] = parseInt(selected.value);
      return true;
    }

    nextBtn.addEventListener('click', () => {
      if (!saveAnswer()) return;
      if (currentQuestion < 49) {
        currentQuestion++;
        loadQuestion(currentQuestion);
      } else {
        showResult();
      }
    });

    prevBtn.addEventListener('click', () => {
      if (currentQuestion > 0) {
        currentQuestion--;
        loadQuestion(currentQuestion);
      }
    });

    function showResult() {
      const total = answers.reduce((sum, val) => sum + val, 0);

      // DefiniciÃ³n de factores (Ã­tems del 1 al 50 â†’ Ã­ndices 0 a 49)
      const factores = {
        autorrealizacion: [0, 5, 10, 15, 20, 25, 30, 35, 40, 45],
        involucramiento: [1, 6, 11, 21, 26, 31, 36, 41, 46],
        supervision: [2, 7, 12, 17, 22, 27, 32, 37, 42, 47],
        comunicacion: [3, 8, 13, 18, 23, 33, 38, 43, 48],
        condiciones: [4, 9, 14, 19, 24, 29, 34, 39, 44, 49]
      };

      const puntajes = {
        autorrealizacion: factores.autorrealizacion.reduce((s, i) => s + answers[i], 0),
        involucramiento: factores.involucramiento.reduce((s, i) => s + answers[i], 0),
        supervision: factores.supervision.reduce((s, i) => s + answers[i], 0),
        comunicacion: factores.comunicacion.reduce((s, i) => s + answers[i], 0),
        condiciones: factores.condiciones.reduce((s, i) => s + answers[i], 0)
      };

      // CategorÃ­a diagnÃ³stica
      let categoria;
      if (total >= 210) categoria = "Muy favorable";
      else if (total >= 170) categoria = "Favorable";
      else if (total >= 130) categoria = "Media";
      else if (total >= 90) categoria = "Desfavorable";
      else categoria = "Muy desfavorable";

      // Percentil aproximado (basado en Tabla 16 del manual)
      const percentil = total <= 112 ? "10%" :
                        total <= 144 ? "25%" :
                        total <= 168 ? "50%" :
                        total <= 193 ? "75%" : "90%";

      // Mensaje tÃ©cnico para WhatsApp
      const mensaje = `ğŸ“Š *RESULTADO ESCALA CLIMA LABORAL (CL-SPC)* ğŸ“Š

*Puntaje Total:* ${total}/250
*CategorÃ­a:* ${categoria}
*Percentil estimado:* ${percentil} (vs. trabajadores de Lima)

*Desglose por factores:*
â€¢ AutorrealizaciÃ³n: ${puntajes.autorrealizacion}/50
â€¢ Involucramiento: ${puntajes.involucramiento}/50
â€¢ SupervisiÃ³n: ${puntajes.supervision}/50
â€¢ ComunicaciÃ³n: ${puntajes.comunicacion}/50
â€¢ Condiciones Laborales: ${puntajes.condiciones}/50

*InterpretaciÃ³n:* 
PercepciÃ³n ${categoria.toLowerCase()} del clima laboral. Se recomienda revisar los factores con puntajes mÃ¡s bajos para intervenciÃ³n organizacional.

â€” Generado con Escala CL-SPC (Palma Carrillo, 2004)`;

      const encodedMsg = encodeURIComponent(mensaje);
      const waLink = `https://wa.me/51984006844?text=${encodedMsg}`;

      // Mostrar resultado en pantalla
      document.getElementById('princessResult').innerHTML = `
        <div class="text-3xl mb-3">ğŸ“Š</div>
        <p class="text-xl font-bold text-indigo-600">Clima Laboral: <span class="text-blue-600">${categoria}</span></p>
        <p class="mt-2 text-sm text-gray-700">Puntaje total: <strong>${total}/250</strong></p>
        <p class="text-xs text-gray-600 mt-2">Percentil estimado: ${percentil}</p>
        <div class="mt-4 text-left text-xs bg-gray-50 p-3 rounded">
          <p><strong>Factores:</strong></p>
          <p>â€¢ AutorrealizaciÃ³n: ${puntajes.autorrealizacion}</p>
          <p>â€¢ Involucramiento: ${puntajes.involucramiento}</p>
          <p>â€¢ SupervisiÃ³n: ${puntajes.supervision}</p>
          <p>â€¢ ComunicaciÃ³n: ${puntajes.comunicacion}</p>
          <p>â€¢ Condiciones: ${puntajes.condiciones}</p>
        </div>
      `;

      // BotÃ³n de WhatsApp
      document.getElementById('whatsappBtnContainer').innerHTML = `
        <a href="${waLink}" target="_blank" class="inline-block bg-green-500 hover:bg-green-600 text-white font-bold py-2.5 px-5 rounded-full text-base transition shadow w-full max-w-xs mx-auto">
          <i class="fab fa-whatsapp mr-2"></i> Enviar Resultado
        </a>
      `;

      questionScreen.classList.add('hidden');
      resultScreen.classList.remove('hidden');
    }
  </script>
</body>
</html>
